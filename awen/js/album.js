window.onload=()=>{const e=window.albumData;const t=window.albumBaseUrl;const n=["#7bd0c1","#7ecaf6","#f2849e","#8499e7","#ae85ca"];const c=3;const o=4;const s=window.innerWidth>580?false:true;const l=document.getElementById("album-back-box");const a=document.getElementById("album-all-text");const i=document.getElementById("album-current-text");const d=document.getElementById("awen-album-cover-box");const m=document.getElementById("domestic-box");const u=document.getElementById("foreign-box");const r=document.getElementById("awen-album-detail-box");const y=document.getElementById("album-we-box");const f=document.getElementById("album-picture-box");const p=document.getElementById("showimg-content");let h=null,g=1,E,x,b,v=0,$=0,w,N,I;let B=null,L,k,M;e.forEach((e=>{const c=document.createElement("div");c.className="city-item";const o=document.createElement("img");o.className="city-img";o.src=`${t}/${e.city}/${e.coverURL}`;c.append(o);const s=document.createElement("div");s.className="city-mask";s.style.backgroundColor=n[Math.floor(Math.random()*5)];c.append(s);const l=document.createElement("div");l.className="city-name";l.innerText=e.city;c.append(l);c.addEventListener("click",(function(){i.innerText="/ "+e.city;Y(e.city);X(true)}));m.append(c)}));if(!s){const t=c-e.length%c;for(let e=0;e<t;e++){const e=document.createElement("div");e.className="city-item";m.append(e)}}a.addEventListener("click",(function(){y.innerHTML="";f.innerHTML="";X(false)}));function X(e){if(e){r.style.display="block";l.style.display="block";d.style.display="none"}else{d.style.display="block";r.style.display="none";l.style.display="none"}}function Y(n){const{we:c,picture:l}=e.find((e=>e.city===n));if(c&&c.length){c.forEach((e=>{const c=document.createElement("div");c.className="detail-item";const o=document.createElement("img");o.className="detail-img";o.src=`${t}/${n}/${e}`;c.append(o);y.append(c)}));if(!s){const e=o-c.length%o;for(let t=0;t<e;t++){const e=document.createElement("div");e.className="detail-item";y.append(e)}}y.style.display="flex"}else{y.style.display="none"}if(l&&l.length){l.forEach((e=>{const c=document.createElement("div");c.className="detail-item";const o=document.createElement("img");o.className="detail-img";o.src=`${t}/${n}/${e.url}`;if(e.info){const t=document.createElement("div");t.className="detail-item-tip";t.innerText=e.info;c.append(t)}c.append(o);f.append(c)}));if(!s){const e=o-l.length%o;for(let t=0;t<e;t++){const e=document.createElement("div");e.className="detail-item";f.append(e)}}f.style.display="flex"}else{f.style.display="none"}T()}function T(){let e=document.querySelectorAll(".article .content img");let t=document.getElementById("showimg");function n(e){p.alt=e.alt;p.src=e.src;t.style.opacity=1;t.style.visibility="visible";h=null;g=1;E;x;b;v=0;$=0;w;N;I;B=null;L;k;M;p.style.transform="none"}function c(){t.style.opacity=0;t.style.visibility="hidden"}for(let t of e)t.addEventListener("click",(function(){n(this)}));t.addEventListener("click",c);window.addEventListener("resize",c)}function q(e){if(e.touches.length==2){const t={x:(e.touches[0].pageX-2*v+e.touches[1].pageX)/2,y:(e.touches[0].pageY-2*$+e.touches[1].pageY)/2,distance:Math.sqrt(Math.pow(e.touches[0].pageX-e.touches[1].pageX,2)+Math.pow(e.touches[0].pageY-e.touches[1].pageY,2))};return t}else if(e.touches.length==1){return{x:e.touches[0].pageX,y:e.touches[0].pageY}}}p.addEventListener("touchstart",(e=>{if(e.touches.length==2){let t=true;for(let n=0;n<e.touches.length;n++){if(e.touches[n].target.nodeName!="IMG"){t=false}}if(t){b=true;h=q(e);E=q(e).x;x=q(e).y}}else if(e.touches.length==1){M=true;B=q(e)}}));p.addEventListener("touchmove",(e=>{e.preventDefault();if(e.touches.length==2){if(b){let t=true;for(let n=0;n<e.touches.length;n++){if(e.touches[n].target.nodeName!="IMG"){t=false}}if(t){const t=q(e);const n=t.distance/h.distance;if(n*g<1)return false;const c={x:h.x*n,y:h.y*n};p.style.transform=`matrix(${n*g}, 0, 0, ${n*g}, ${t.x+v-c.x}, ${t.y+$-c.y})`;w=t.x+v-c.x;N=t.y+$-c.y;I=n*g}}}else if(e.touches.length==1){if(M){const t={x:e.touches[0].pageX,y:e.touches[0].pageY};p.style.transform=`matrix(${I}, 0, 0, ${I}, ${t.x-B.x+v}, ${t.y-B.y+$})`;w=t.x-B.x+v;N=t.y-B.y+$}}}));p.addEventListener("touchend",(e=>{p.style.transform=`matrix(${I}, 0, 0, ${I}, ${w}, ${N})`;v=w;$=N;g=I}))};