window.onload=()=>{const e=window.albumData;const t=["#7bd0c1","#7ecaf6","#f2849e","#8499e7","#ae85ca"];const n=3;const c=4;const o=window.innerWidth>580?false:true;const s=document.getElementById("album-back-box");const l=document.getElementById("album-all-text");const a=document.getElementById("album-current-text");const i=document.getElementById("awen-album-cover-box");const d=document.getElementById("domestic-box");const m=document.getElementById("foreign-box");const u=document.getElementById("awen-album-detail-box");const r=document.getElementById("album-we-box");const y=document.getElementById("album-picture-box");const f=document.getElementById("showimg-content");let p=null,h=1,g,E,x,v=0,b=0,w,N,I;let $=null,B,L,k;e.forEach((e=>{const n=document.createElement("div");n.className="city-item";const c=document.createElement("img");c.className="city-img";c.src=e.coverURL;n.append(c);const o=document.createElement("div");o.className="city-mask";o.style.backgroundColor=t[Math.floor(Math.random()*5)];n.append(o);const s=document.createElement("div");s.className="city-name";s.innerText=e.city;n.append(s);n.addEventListener("click",(function(){a.innerText="/ "+e.city;T(e.city);M(true)}));d.append(n)}));if(!o){const t=n-e.length%n;for(let e=0;e<t;e++){const e=document.createElement("div");e.className="city-item";d.append(e)}}l.addEventListener("click",(function(){r.innerHTML="";y.innerHTML="";M(false)}));function M(e){if(e){u.style.display="block";s.style.display="block";i.style.display="none"}else{i.style.display="block";u.style.display="none";s.style.display="none"}}function T(t){const{we:n,picture:s}=e.find((e=>e.city===t));if(n&&n.length){n.forEach((e=>{const t=document.createElement("div");t.className="detail-item";const n=document.createElement("img");n.className="detail-img";n.src=e.url;if(e.info){const n=document.createElement("div");n.className="detail-item-tip";n.innerText=e.info;t.append(n)}t.append(n);r.append(t)}));if(!o){const e=c-n.length%c;for(let t=0;t<e;t++){const e=document.createElement("div");e.className="detail-item";r.append(e)}}r.style.display="flex"}else{r.style.display="none"}if(s&&s.length){s.forEach((e=>{const t=document.createElement("div");t.className="detail-item";const n=document.createElement("img");n.className="detail-img";n.src=e.url;if(e.info){const n=document.createElement("div");n.className="detail-item-tip";n.innerText=e.info;t.append(n)}t.append(n);y.append(t)}));if(!o){const e=c-s.length%c;for(let t=0;t<e;t++){const e=document.createElement("div");e.className="detail-item";y.append(e)}}y.style.display="flex"}else{y.style.display="none"}X()}function X(){let e=document.querySelectorAll(".article .content img");let t=document.getElementById("showimg");function n(e){f.alt=e.alt;f.src=e.src;t.style.opacity=1;t.style.visibility="visible";p=null;h=1;g;E;x;v=0;b=0;w;N;I;$=null;B;L;k;f.style.transform="none"}function c(){t.style.opacity=0;t.style.visibility="hidden"}for(let t of e)t.addEventListener("click",(function(){n(this)}));t.addEventListener("click",c);window.addEventListener("resize",c)}function Y(e){if(e.touches.length==2){const t={x:(e.touches[0].pageX-2*v+e.touches[1].pageX)/2,y:(e.touches[0].pageY-2*b+e.touches[1].pageY)/2,distance:Math.sqrt(Math.pow(e.touches[0].pageX-e.touches[1].pageX,2)+Math.pow(e.touches[0].pageY-e.touches[1].pageY,2))};return t}else if(e.touches.length==1){return{x:e.touches[0].pageX,y:e.touches[0].pageY}}}f.addEventListener("touchstart",(e=>{if(e.touches.length==2){let t=true;for(let n=0;n<e.touches.length;n++){if(e.touches[n].target.nodeName!="IMG"){t=false}}if(t){x=true;p=Y(e);g=Y(e).x;E=Y(e).y}}else if(e.touches.length==1){k=true;$=Y(e)}}));f.addEventListener("touchmove",(e=>{e.preventDefault();if(e.touches.length==2){if(x){let t=true;for(let n=0;n<e.touches.length;n++){if(e.touches[n].target.nodeName!="IMG"){t=false}}if(t){const t=Y(e);const n=t.distance/p.distance;if(n*h<1)return false;const c={x:p.x*n,y:p.y*n};f.style.transform=`matrix(${n*h}, 0, 0, ${n*h}, ${t.x+v-c.x}, ${t.y+b-c.y})`;w=t.x+v-c.x;N=t.y+b-c.y;I=n*h}}}else if(e.touches.length==1){if(k){const t={x:e.touches[0].pageX,y:e.touches[0].pageY};f.style.transform=`matrix(${I}, 0, 0, ${I}, ${t.x-$.x+v}, ${t.y-$.y+b})`;w=t.x-$.x+v;N=t.y-$.y+b}}}));f.addEventListener("touchend",(e=>{f.style.transform=`matrix(${I}, 0, 0, ${I}, ${w}, ${N})`;v=w;b=N;h=I}))};